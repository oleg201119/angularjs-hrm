function validateEmail($email){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return emailReg.test($email)}function EditUser(id){$(".user-message").removeClass("error").removeClass("success").html("&nbsp;"),$.ajax({method:"POST",url:"admin/ajax.php",data:{action:"getUser",id:id},dataType:"json",async:!1,success:function(data){$modalContent.modal("show"),$("#manageUser").html("Edit User"),$.each(data,function(key,val){var $fld=$("#"+key);$fld.length>0&&$fld.val(val)})},fail:function(data){},complete:function(data){}})}function DeleteUser(id){var userdata=$.parseJSON(users),user=_.find(userdata.rows,function(o){return o.id==id}),answer=confirm("Are you sure you want to delete this user: "+user.data[0]+"?");answer&&$.ajax({method:"POST",url:"admin/ajax.php",data:{action:"deleteUser",id:id},dataType:"json",async:!1,success:function(data){myGrid.clearAll(),myGrid.parse(data,"json"),myGrid.filterByAll()},fail:function(data){},complete:function(data){}})}var myGrid;myGrid=new dhtmlXGridObject("gridbox"),myGrid.setImagePath("assets/js/dhtml/codebase/imgs/"),myGrid.setHeader("Name,Password,Login, Trading Name, Account Type, State, Expiry Date, Status, Action"),myGrid.attachHeader("#text_filter,#text_filter,#text_filter,#text_filter,#select_filter,#text_filter,,#select_filter"),myGrid.setInitWidthsP("15,6,20,20,7,5.3,10.5,8.7,7"),myGrid.setColAlign("left,center,center,center,center,center, center, center, center"),myGrid.setColTypes("txt,txt,txt,txt,txt,txt,txt,txt,txt"),myGrid.setColSorting("str,str,str,str,str,str,str,str,str"),myGrid.init(),myGrid.enableSmartRendering(!0),myGrid.parse(users,"json"),myGrid.filterBy(7,"Active");var $modalContent=$("#usercontent");$("#save-user").click(function(){$(".field-error").removeClass("field-error"),$(".user-message").removeClass("error").removeClass("success").html("&nbsp;");var id,data={},valid=!0;return $(".modal-body input, .modal-body select").each(function(idx,element){$(element).hasClass("required")&&""==$.trim($(element).val())&&(valid=!1,$(element).addClass("field-error")),id=$(element).attr("id"),"email"==id&&(validateEmail($(element).val())||(valid=!1,$(element).addClass("field-error"))),data[id]=$(element).val()}),valid?void $.ajax({method:"POST",url:"admin/ajax.php",data:{action:"saveUser",data:data},dataType:"json",async:!1,success:function(response){$("#manageUser").html("Edit User"),$("#id").val(response.id),"undefined"!=typeof response.regdate&&$("#regdate").val(response.regdate),$(".user-message").addClass("success").html("The user has been saved successfully"),myGrid.clearAll(),myGrid.parse(response.users,"json"),myGrid.filterBy(7,"Active")},fail:function(data){},complete:function(data){}}):void $(".user-message").addClass("error").html("Your form contains errors. Please correct before proceeding.")}),$(".create-user span").click(function(){$modalContent.modal("show"),$(".field-error").removeClass("field-error"),$(".user-message").removeClass("error").removeClass("success").html("&nbsp;"),$("#manageUser").html("Create User"),$(".modal-body input, .modal-body select").val(""),$("#enabled").val(1),$("#id").val(0)}),$(document).ready(function(){if($("#regdate, #daterenewed, #expiredate").attr("disabled","disabled").addClass("disabled"),$("#expiredate").length>0){var myCalendar=new dhtmlXCalendarObject({input:"expiredate",button:"renewCalendar"});myCalendar.setDateFormat("%d-%m-%Y")}});